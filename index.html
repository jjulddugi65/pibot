<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOR Pi MAXIMUM TRANSACTION Demo (pibot - SDK Mocked)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* CSS Styles */
        body {
            font-family: sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
            padding: 2rem 1rem;
        }
        .container {
            max-width: 1200px;
            margin: auto;
        }
        .header {
            background-color: #1f2937;
            color: white;
            padding: 2rem;
            border-radius: 1rem;
        }
        .simulator-section {
            background: white;
            padding: 2rem;
            margin: 2rem 0 0 0;
            border-radius: 1rem 1rem 0 0;
            box-shadow: 0 2px 15px -5px rgba(0, 0, 0, 0.1);
        }
        /* --- [ÏàòÏ†ï] Ïù∏ÌîåÎ†àÏù¥ÏÖò Ï∞®Ìä∏ ÎÜíÏù¥ Ï°∞Ï†ï --- */
        #inflation_chart {
            height: 120px; 
            margin-top: 1rem;
        }
        .bar:hover {
            opacity: 0.7;
        }
    </style>
</head>
<body class="bg-gray-100">

<div class="container mx-auto">
    
    <div class="header shadow-lg">
        <h1 class="text-3xl font-bold mb-2">FOR Pi MAXIMUM TRANSACTION Demo</h1>
        <p class="text-gray-300">Stripped-Bare Blockchain, and User-Centric Decentralization</p>
        <p class="text-sm mt-3">Active App: **pibot** (Alternative Deployment for Hackathon)</p>
    </div>

    <div class="simulator-section">
        <h2 class="text-2xl font-semibold text-gray-700 border-b pb-3 mb-4">1. Pi SDK Connectivity Test (pibot)</h2>
        
        <div class="flex flex-wrap gap-4 mb-6">
            <button onclick="piAuthenticate()" class="bg-pi-green-600 hover:bg-pi-green-700 text-white font-bold py-2 px-4 rounded shadow-md transition duration-150 ease-in-out" style="background-color: #008080;">
                üîê 1. Pi Login (Identify User - MOCKED)
            </button>
            <button onclick="piRequestPayment()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded shadow-md transition duration-150 ease-in-out">
                üí∞ 2. Request Pi Payment (Start SC - MOCKED)
            </button>
        </div>
        
        <h3 class="text-xl font-semibold mt-6 text-gray-700">2. Transaction Simulator</h3>
        <p class="mt-2 text-sm text-gray-500">Simulate the complexity of a creator's work leading to a Smart Contract activation.</p>
        
        <div class="mt-4 p-4 border rounded-lg bg-gray-50">
            <p class="text-lg font-medium">Work Cost (Simulated): <span id="work_cost" class="text-blue-600 font-bold">0.00</span> Pi</p>
            <p class="text-lg font-medium mt-1">Active Smart Contract: <span id="sc_type" class="text-red-600 font-bold">1st SC (Survival)</span></p>
            <button onclick="runSimulation()" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out">
                Run Transaction Simulation
            </button>
        </div>
    </div>

    <div class="simulator-section mt-4 pt-0">
        <h2 class="text-2xl font-semibold text-gray-700 pt-6 border-t pb-3 mb-4">3. Inflation & Value Stability (Demo)</h2>
        <p class="text-sm text-gray-500">Visualization of the stable inflation rate managed by the 1st Smart Contract logic.</p>
        <div id="inflation_chart">
            </div>
        
        <div class="mt-4 text-center">
            <p class="text-sm text-gray-600">This chart demonstrates the 1st Smart Contract's role in maintaining long-term Pi value stability.</p>
        </div>
    </div>

    <div class="mt-8 p-4 bg-white rounded-b-xl shadow-lg border-t-4 border-pi-green-600" style="border-top-color: #008080;">
        <h3 class="text-xl font-semibold text-gray-700">Project Goal: Maximize Pi Utility</h3>
        <p class="mt-2 text-gray-600">The goal is to drive massive, consistent transactions (TPS increase) by rewarding AI creators and users based on the complexity of their work, controlled by dual Smart Contracts (Survival & Market).</p>
        <p class="mt-2 text-red-500 font-bold">IMPORTANT: The Pi SDK functions below are mocked for demonstration purposes.</p>
    </div>

</div>

<script>
    // --- [ÏàòÏ†ï] Ïï± ÌÇ§ Î≥ÄÍ≤Ω ---
    // ÏÉàÎ°úÏö¥ 'pibot' Ïï±Ïùò ÌÇ§Î°ú Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.
    const APP_KEY = "h8bfa63icup59xvcuegotibezgxnv5dawpnlkhks1dloukl1xbfxtrhgajaoujhx";

    // Pi SDK Ïä§ÌÅ¨Î¶ΩÌä∏Î•º ÎèôÏ†ÅÏúºÎ°ú Î°úÎìú (Ïã§Ï†ú SDK ÏÇ¨Ïö© Ïãú ÌïÑÏöî)
    (function() {
        const script = document.createElement('script');
        script.src = 'https://sdk.minepi.com/pi-sdk.js';
        script.async = true;
        script.onload = () => {
             console.log("Pi SDK loaded. App Key:", APP_KEY);
             // Pi SDK Ï¥àÍ∏∞Ìôî (Ïã§Ï†ú ÏÇ¨Ïö© Ïãú MOCKED Ìï®Ïàò Ï†úÍ±∞ ÌõÑ ÏÇ¨Ïö©)
             // Pi.init({ version: "2.0", api_key: APP_KEY }); 
        };
        document.head.appendChild(script);
    })();

    // ----------------------------------------------------------------------
    // MOCKED SDK FUNCTIONS (For Local Demo/Hackathon Submission)
    // ----------------------------------------------------------------------

    function piAuthenticate() {
        // Ïã§Ï†ú SDK ÏÇ¨Ïö© Ïãú: Pi.authenticate({...});
        alert(`[MOCKED] Pi SDK Login/Authentication attempted with App Key: ${APP_KEY}\n\n[SUCCESS] Pi Authentication Pop-up (or Mock) will appear here.`);
        console.log("MOCKED: Pi.authenticate called.");
    }

    function piRequestPayment() {
        // Ïã§Ï†ú SDK ÏÇ¨Ïö© Ïãú: Pi.requestPayment({...});
        const paymentData = {
            amount: 0.1, 
            memo: "Transaction for 1st Smart Contract activation", 
            metadata: { transaction_type: "SC_1_activation" }
        };
        alert(`[MOCKED] Pi SDK Payment requested:\nAmount: ${paymentData.amount} Pi\nMemo: ${paymentData.memo}\n\n[SUCCESS] Pi Payment Pop-up (or Mock) will appear here.`);
        console.log("MOCKED: Pi.requestPayment called.", paymentData);
    }
    
    // ----------------------------------------------------------------------
    // SIMULATOR LOGIC
    // ----------------------------------------------------------------------

    function runSimulation() {
        // ÏãúÎÆ¨Î†àÏù¥ÏÖò: 0.01ÏóêÏÑú 4.0 ÏÇ¨Ïù¥Ïùò ÎûúÎç§ ÏûëÏóÖ ÎπÑÏö© ÏÉùÏÑ±
        let workCost = (Math.random() * (4.0 - 0.01) + 0.01).toFixed(2);
        
        let scType;
        
        // ÌïµÏã¨ Î°úÏßÅ: ÏûëÏóÖ ÎπÑÏö©Ïóê Îî∞Îùº ÌôúÏÑ±ÌôîÎêòÎäî Ïä§ÎßàÌä∏ Ïª®Ìä∏ÎûôÌä∏ Í≤∞Ï†ï
        if (workCost >= 2.0) {
            // 2.0 Pi Ïù¥ÏÉÅÏùÄ Í≥†Í∞ÄÏπò/Î≥µÏû° ÏûëÏóÖÏúºÎ°ú Í∞ÑÏ£º
            scType = '2nd SC (Market)';
        } else {
            // 2.0 Pi ÎØ∏ÎßåÏùÄ Í∏∞Î≥∏/Î∞òÎ≥µ ÏûëÏóÖÏúºÎ°ú Í∞ÑÏ£º
            scType = '1st SC (Survival)';
        }

        // Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏
        document.getElementById('work_cost').textContent = workCost;
        document.getElementById('sc_type').textContent = scType;
        
        // ÏÉâÏÉÅ Î≥ÄÍ≤Ω
        document.getElementById('work_cost').classList.remove('text-blue-600', 'text-green-600');
        document.getElementById('sc_type').classList.remove('text-red-600', 'text-green-600');

        if (scType === '2nd SC (Market)') {
            document.getElementById('work_cost').classList.add('text-green-600');
            document.getElementById('sc_type').classList.add('text-green-600');
        } else {
            document.getElementById('work_cost').classList.add('text-blue-600');
            document.getElementById('sc_type').classList.add('text-red-600');
        }
    }


    // ----------------------------------------------------------------------
    // D3.js Chart Rendering
    // ----------------------------------------------------------------------

    function renderChart() {
        // ÏãúÎÆ¨Î†àÏù¥ÏÖò Îç∞Ïù¥ÌÑ∞: Pi Í∞ÄÏπò ÏïàÏ†ïÏÑ±ÏùÑ ÏúÑÌïú ÎÇÆÏùÄ Ïù∏ÌîåÎ†àÏù¥ÏÖòÏú® (Ïòà: 1.05%, 1.02%, 0.98%, 1.01%)
        const data = [1.05, 1.02, 0.98, 1.01]; 
        
        const margin = {top: 10, right: 30, bottom: 20, left: 40};
        const width = document.querySelector('.container').offsetWidth * 0.95 - margin.left - margin.right; 
        const height = 120 - margin.top - margin.bottom; // CSS height: 120pxÏôÄ ÏùºÏπòÌïòÎèÑÎ°ù ÏàòÏ†ï

        const svgContainer = d3.select('#inflation_chart').append('div')
            .style('width', '100%')
            .style('height', `${height + margin.top + margin.bottom}px`);

        const svg = svgContainer.append('svg')
           .attr('width', '100%')
            .attr('height', height + margin.top + margin.bottom);                        

        const x = d3.scaleBand().range([0, width]).padding(0.3);
        const y = d3.scaleLinear().range([height, 0]);

        const g = svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        x.domain(data.map((d, i) => 'Q' + (i + 1))); 
        y.domain([0, d3.max(data, d => d) + 0.5]);

        // YÏ∂ï ÏÉùÏÑ±
        g.append("g")
            .call(d3.axisLeft(y).ticks(3).tickFormat(d3.format(".1f"))); // Ï∂ïÏÜåÎêú ÎÜíÏù¥Ïóê ÎßûÏ∂∞ ÎààÍ∏à Í∞úÏàò Ï°∞Ï†ï

        // ÎßâÎåÄ Í∑∏ÎûòÌîÑ ÏÉùÏÑ±
        g.selectAll(".bar")
            .data(data)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", (d, i) => x('Q' + (i + 1)))
            .attr("y", d => y(d))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d))
            .attr("fill", "#008080"); // Pi Green color

        // XÏ∂ï ÏÉùÏÑ±
        g.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x));

        // Ï†úÎ™© Î∞è Î†àÏù¥Î∏î (ÏÉùÎûµ - ÎîîÏûêÏù∏ Í∞ÑÏÜåÌôîÎ•º ÏúÑÌï¥)
    }

    // Ï¥àÍ∏∞ Ïã§Ìñâ
    document.addEventListener('DOMContentLoaded', () => {
        renderChart();
        // ÏãúÎÆ¨Î†àÏù¥ÏÖò Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
        document.getElementById('work_cost').textContent = '0.00';
        document.getElementById('sc_type').textContent = '1st SC (Survival)';
    });
</script>
</body>
</html>
